!SESSION 2015-08-11 13:23:24.853 -----------------------------------------------
eclipse.buildId=4.5.0.I20150603-2000
java.version=1.7.0_80
java.vendor=Oracle Corporation
BootLoader constants: OS=macosx, ARCH=x86_64, WS=cocoa, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.java.product -keyring /Users/brown303/.eclipse_keyring -showlocation
Command-line arguments:  -os macosx -ws cocoa -arch x86_64 -product org.eclipse.epp.package.java.product -keyring /Users/brown303/.eclipse_keyring -showlocation

!ENTRY org.eclipse.core.net 1 0 2015-08-11 13:23:33.943
!MESSAGE System property http.nonProxyHosts has been set to local|*.local|169.254/16|*.169.254/16 by an external source. This value will be overwritten using the values from the preferences
!SESSION 2015-08-11 13:25:14.235 -----------------------------------------------
eclipse.buildId=4.5.0.I20150603-2000
java.version=1.7.0_80
java.vendor=Oracle Corporation
BootLoader constants: OS=macosx, ARCH=x86_64, WS=cocoa, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.java.product -product org.eclipse.epp.package.java.product -keyring /Users/brown303/.eclipse_keyring -showlocation
Command-line arguments:  -os macosx -ws cocoa -arch x86_64 -product org.eclipse.epp.package.java.product -data file:/Users/brown303/workspace/eclipse/ -product org.eclipse.epp.package.java.product -keyring /Users/brown303/.eclipse_keyring -showlocation

!ENTRY org.eclipse.core.net 1 0 2015-08-11 13:25:18.332
!MESSAGE System property http.nonProxyHosts has been set to local|*.local|169.254/16|*.169.254/16 by an external source. This value will be overwritten using the values from the preferences

!ENTRY org.eclipse.jdt.core 4 4 2015-08-11 17:09:43.870
!MESSAGE Exception occurred during compilation unit conversion:
----------------------------------- SOURCE BEGIN -------------------------------------
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.Map;
import java.io.Console;
import java.io.File;
import java.io.FileWriter;

import gov.llnl.lc.infiniband.opensm.plugin.data.OSM_SysInfo;
import gov.llnl.lc.infiniband.opensm.plugin.net.OsmClientApi;
import gov.llnl.lc.infiniband.opensm.plugin.net.OsmServiceManager;
import gov.llnl.lc.infiniband.opensm.plugin.net.OsmSession;
import gov.llnl.lc.infiniband.core.IB_Guid;
import gov.llnl.lc.infiniband.core.IB_Link;
import gov.llnl.lc.infiniband.opensm.plugin.data.*;

public class OSMHBase {
	public static void main(String[] args) throws Exception
	{

		OMS_Collection omsHistory = null;
		try
		{
			int i;
			omsHistory = OMS_Collection.readOMS_Collection("/Users/brown303/workspace/llnl/networks/oms/cab.20150730.his");
			OpenSmMonitorService oms = omsHistory.getNewestOMS();
			RT_Table RoutingTable = RT_Table.buildRT_Table(oms.getFabric());
			LinkedHashMap<String, IB_Link> ibLinks = oms.getFabric().getIB_Links();
			
			
			LinkedHashMap<String,RT_Port> rtable = RoutingTable.getRT_Node(7).getPortRouteMap(); //getRT_Port(1).toLongString();
			//RT_Table.writeRT_Table("/Users/brown303/workspace/eclipse/OSM-HBASE/data/route.table", RoutingTable);
			System.out.println("Record format: \"<ExitPort>:<LID>\"");
			System.out.println("----BEGIN----");
			RT_Node node = RoutingTable.getRT_Node(7);
			
			String nguid = node.getGuid().toColonString().replace(":", "");
			System.out.println("Switch: 0x" + nguid);
			
			for (Map.Entry<String,RT_Port> entry: rtable.entrySet()){
				RT_Port port = entry.getValue();
				
				Integer portNum = port.getPortNumber();
				HashMap<String, Integer> routes =  port.getLidGuidMap();
				
				for (Map.Entry<String,Integer> item: routes.entrySet()){
					Integer routeLid = item.getValue();
					
					if(portNum == 1){
						System.out.println(portNum + ":" + routeLid);
					}
				}
				
				String pn = port.toLongString();
				
				//System.out.println(route + " - " + pn);
			}

			writePortForwardingTable(RoutingTable);
			
			StringBuffer buff = new StringBuffer();
			buff.append("Links: \n");
			
			/*
			for(Map.Entry<String, IB_Link> entry: ibLinks.entrySet()){
		        String rn = entry.getKey();
		        IB_Link ln = entry.getValue();
		        
		        OSM_Port port1 = ln.getEndpoint1();
		        OSM_Port port2 = ln.getEndpoint2();
		        
		        IB_Guid nguid1 = port1.getNodeGuid();
		        IB_Guid nguid2 = port2.getNodeGuid();
		        
		        int pn1 =  port1.getPortNumber();
		        int pn2 =  port2.getPortNumber();
		        
		        String ntyp1 = port1.getNodeType().getAbrevName();
		        String ntyp2 = port2.getNodeType().getAbrevName();
		        
		        int lid1 = port1.getAddress().getLocalId();
		        int lid2 = port2.getAddress().getLocalId();
		        
		        buff.append(nguid1 + ":" + nguid2 + ":" + pn1  + ":" + pn2  + ":" + ntyp1 + ":" + ntyp2 + ":" + lid1 + ":" + lid2 + "\n");
			}
			File file = new File("/Users/brown303/workspace/eclipse/OSM-HBASE/data/links.table-0730");
			if (!file.exists()) {
				file.createNewFile();
			}
			FileWriter fw = new FileWriter(file.getAbsoluteFile());
			BufferedWriter bw = new BufferedWriter(fw);
			bw.write(buff.toString());
			bw.close();
			*/
			
		
		}
		catch (Exception e)
		{
			System.err.println("Couldn't open the file");
			e.printStackTrace();
		}
		
		System.out.println("----END----");

	}
	
	private static void writePortForwardingTable(RT_Table RoutingTable){
		StringBuffer buffer = new StringBuffer();
		HashMap<String, RT_Node> switches = RoutingTable.getSwitchGuidMap();
	
		buffer.append("Record format: \"<ExitPort>:<LID>\"");
		
		for (Map.Entry<String, >)
		
		
		System.out.println(switches.size());
		
	}
	
	public static void WorkConsole(String[] args) throws Exception
	{
		// Get input using IDE
		/*
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		System.out.print("Enter oun: ");
		String oun = br.readLine();
		System.out.print("Enter otp: ");
		String otp = br.readLine();
		*/
		
		// Get input at console (non-IDE)
		Console console = System.console();
		String oun = console.readLine("Enter username: ");
		String otp = new String(console.readPassword("Enter OTP: "));
		
		// establish a connection, and dump the system info
	    OsmSession ParentSession = null;
	    /* the one and only OsmServiceManager */
	    OsmServiceManager OsmService = OsmServiceManager.getInstance();
	    try
	    {
	      ParentSession = OsmService.openSession("cab664.llnl.gov", "10011", oun, otp);
	    }
	    catch (Exception e)
	    {
	      System.err.println(e.getStackTrace().toString());
	      System.exit(-1);
	    }
	    if (ParentSession != null)
	    {
	      OsmClientApi clientInterface = ParentSession.getClientApi();
	      /* use the api's to get the system information */
	      OSM_SysInfo sysinfo = clientInterface.getOsmSysInfo();
	      System.out.println(sysinfo);
	      /* all done, so close the session(s) */
	      OsmService.closeSession(ParentSession);
	    }
	}
}

----------------------------------- SOURCE END -------------------------------------
!STACK 0
java.lang.IllegalArgumentException
	at org.eclipse.jdt.core.dom.ASTNode.setSourceRange(ASTNode.java:2845)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2207)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1780)
	at org.eclipse.jdt.core.dom.ASTConverter.convertToParenthesizedExpression(ASTConverter.java:3231)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1683)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1090)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1714)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2751)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1886)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2671)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:635)
	at org.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations(ASTConverter.java:195)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2958)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1374)
	at org.eclipse.jdt.core.dom.AST.convertCompilationUnit(AST.java:270)
	at org.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:202)
	at org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:259)
	at org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:579)
	at org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:1085)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.makeConsistent(ReconcileWorkingCopyOperation.java:171)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:90)
	at org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:729)
	at org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:789)
	at org.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1250)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:126)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.access$0(JavaReconcilingStrategy.java:108)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy$1.run(JavaReconcilingStrategy.java:89)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:87)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:151)
	at org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:86)
	at org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:104)
	at org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:77)
	at org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:206)

!ENTRY org.eclipse.jdt.ui 4 2 2015-08-11 17:09:43.992
!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.jdt.ui".
!STACK 0
java.lang.IllegalArgumentException
	at org.eclipse.jdt.core.dom.ASTNode.setSourceRange(ASTNode.java:2845)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2207)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1780)
	at org.eclipse.jdt.core.dom.ASTConverter.convertToParenthesizedExpression(ASTConverter.java:3231)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1683)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1090)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1714)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2751)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1886)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2671)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:635)
	at org.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations(ASTConverter.java:195)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2958)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1374)
	at org.eclipse.jdt.core.dom.AST.convertCompilationUnit(AST.java:270)
	at org.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:202)
	at org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:259)
	at org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:579)
	at org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:1085)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.makeConsistent(ReconcileWorkingCopyOperation.java:171)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:90)
	at org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:729)
	at org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:789)
	at org.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1250)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:126)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.access$0(JavaReconcilingStrategy.java:108)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy$1.run(JavaReconcilingStrategy.java:89)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:87)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:151)
	at org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:86)
	at org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:104)
	at org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:77)
	at org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:206)

!ENTRY org.eclipse.jdt.ui 4 0 2015-08-11 17:09:43.999
!MESSAGE Error in JDT Core during reconcile
!STACK 0
java.lang.IllegalArgumentException
	at org.eclipse.jdt.core.dom.ASTNode.setSourceRange(ASTNode.java:2845)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2207)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1780)
	at org.eclipse.jdt.core.dom.ASTConverter.convertToParenthesizedExpression(ASTConverter.java:3231)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1683)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1090)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1714)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2751)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1886)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2671)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:635)
	at org.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations(ASTConverter.java:195)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2958)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1374)
	at org.eclipse.jdt.core.dom.AST.convertCompilationUnit(AST.java:270)
	at org.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:202)
	at org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:259)
	at org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:579)
	at org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:1085)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.makeConsistent(ReconcileWorkingCopyOperation.java:171)
	at org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:90)
	at org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:729)
	at org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:789)
	at org.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1250)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:126)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.access$0(JavaReconcilingStrategy.java:108)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy$1.run(JavaReconcilingStrategy.java:89)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:87)
	at org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:151)
	at org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:86)
	at org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:104)
	at org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:77)
	at org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:206)
